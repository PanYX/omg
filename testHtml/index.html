<!DOCTYPE html>
<html>
<head>
	<title>test html</title>
	<style>
		#canvas {
			background-color: #ccc;
		}
		.drag li {
			list-style: none;
			width: 200px;
			height: 40px;
			background-color: #ef8376;
		}
	</style>
</head>
<body>
<div class="container">
		<canvas id="canvas"></canvas>
</div>
<button id="start">start</button>
<button id="stop">stop</button>
<ul class="drag">
	<li id="dg" draggable="true">Drag</li>
</ul>
<script src="../dist/lcl.js"></script>
<script>
  var flag;

	var start = document.getElementById('start');
	var stop = document.getElementById('stop');
	var stage = LCL.init({
		element: document.getElementById('canvas'),
		width: 500,
		height: 500,
		enableGlobalTranslate: true
	});

	//stage.scaleCanvas(true);

	var rect1 = LCL.rectangle({
		startX: 0,
		startY: 0,
		width: 110,
		height: 110,
		fillColor: '#'+(~~(Math.random()*(1<<24))).toString(16)
	}).on('mousedown', function() {
		console.log('click rect1');
	}).on('mouseenter', function() {
		rect1.fillColor = '#'+(~~(Math.random()*(1<<24))).toString(16);
		stage.redraw();
	}).on('mouseleave', function() {
		rect1.fillColor = '#'+(~~(Math.random()*(1<<24))).toString(16);
		stage.redraw();
	}).config({
		drag: true,
		changeIndex: true
	});

	var rect2 = LCL.rectangle({
		startX: 120,
		startY: 120,
		width: 200,
		height: 200,
		fillColor: '#'+(~~(Math.random()*(1<<24))).toString(16)
	}).on('mousedown', function() {
		console.log('click rect2');
	}).on('mouseenter', function() {
		rect2.fillColor = '#'+(~~(Math.random()*(1<<24))).toString(16);
		stage.redraw();
	}).on('mouseleave', function() {
		rect2.fillColor = '#'+(~~(Math.random()*(1<<24))).toString(16);
		stage.redraw();
	}).on('dragin', function() {
		console.log('drag in rect2');
		rect2.fillColor = '#ffffff';
		stage.redraw();
	}).on('dragout', function() {
		console.log('drag out rect2');
		rect2.fillColor = '#'+(~~(Math.random()*(1<<24))).toString(16);
		stage.redraw();
	}).on('drop', function() {
		console.log('you drop on the rect2!');
		rect2.fillColor = '#000';
		stage.redraw();
	}).config({
		drag: true,
		changeIndex: true
	});

	stage.addChild(rect1);
	stage.addChild(rect2);

	stage.show();

	// drag and drop

	var dg = document.getElementById('dg');
	dg.onselectstart = function() {
    return false;
  };
  dg.ondragstart = function(ev) {
    ev.dataTransfer.effectAllowed = "move";
    //ev.dataTransfer.setData("text", ev.target.innerHTML);
    ev.dataTransfer.setDragImage(ev.target, 0, 0);
    return true;
  };

  LCL.element.ondragover = function(e) {
  	e.preventDefault();
  	var x = LCL.event.getPos(e).x;
  	var y = LCL.event.getPos(e).y;
  	console.log(x, y)
  	var which = LCL._objects.filter(function(item) {
  		return item.isPointInner(x, y);
  	});
  	if(which.length > 0 ) {
  		which[0].fillColor = '#000';
  		stage.redraw();
  	}
  }

  LCL.element.ondrop = function(ev) {
  	var x = LCL.event.getPos(ev).x;
  	var y = LCL.event.getPos(ev).y;
  	var width = Math.random()*300;
    var a = LCL.rectangle({
			startX: x,
			startY: y,
			width: width,
			height: width,
			fillColor: '#'+(~~(Math.random()*(1<<24))).toString(16)
		}).on('mousedown', function() {
			console.log('click a');
		}).on('mouseenter', function() {
			a.fillColor = '#'+(~~(Math.random()*(1<<24))).toString(16);
			stage.redraw();
		}).on('mouseleave', function() {
			a.fillColor = '#'+(~~(Math.random()*(1<<24))).toString(16);
			stage.redraw();
		}).config({
			drag: true,
			changeIndex: true
		});

    stage.addChild(a);

		stage.redraw();
    return false;
	};


	//flag = stage.animate(go);
	//setInterval(go, 10);
	function go() {
		LCL.objects.forEach(function(i) {
			i.rotate++;
		});
		stage.redraw();
	}
	start.onclick = function() {
		flag = stage.animate(go);
	}
	stop.onclick = function() {
		stage.stop(flag);
	}

</script>
</body>
</html>